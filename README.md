# RFM-SEGMENT-AND-CUSTOMER-ANALYSIS-SQL
This project utilizes SQL to analyze and uncover meaningful customer behavior patterns.
ðŸ“Š Customer RFM Segmentation Using SQL
ðŸ” Project Overview

This project performs RFM (Recency, Frequency, Monetary) Segmentation using SQL to classify customers based on their purchasing behavior. It helps identify key segments such as Champions, Loyal Customers, At-Risk Customers, and Lost Customers â€” improving data-driven marketing decisions.


```sql
#Dap tabase Setu
CREATE DATABASE RFM;
USE RFM;

SELECT min(str_to_date(ORDERDATE,'%d/%m/%y')) AS MIN_ORDER_DATE,
       max(str_to_date(ORDERDATE,'%d/%m/%y')) AS MAX_ORDER_DATE
FROM SAMPLE_RFM;

SELECT COUNT(DISTINCT CUSTOMERNAME) FROM SAMPLE_RFM;



WITH RFM_VALUES AS
(
SELECT
CUSTOMERNAME,
DATEDIFF((SELECT max(str_to_date(ORDERDATE,'%d/%m/%y')) FROM SAMPLE_RFM ),
        max(str_to_date(ORDERDATE,'%d/%m/%y'))) AS RECENCY_VALUE,
COUNT(DISTINCT(ORDERNUMBER)) AS FREQUENCY_VALUE,
ROUND(SUM(SALES),0) AS MONETARY_VALUE
FROM SAMPLE_RFM
WHERE SALES >= 0
GROUP BY CUSTOMERNAME
)



, RFM_SCORES AS
(
SELECT
RV.*,
NTILE(5) OVER(ORDER BY RECENCY_VALUE DESC) AS R_SCORE,
NTILE(5) OVER(ORDER BY FREQUENCY_VALUE ASC) AS F_SCORE,
NTILE(5) OVER(ORDER BY MONETARY_VALUE ASC) AS M_SCORE
FROM RFM_VALUES RV
)




, RFM_COMBINATION AS
(
SELECT 
RS.*, 
(R_SCORE + F_SCORE + M_SCORE) AS TOTAL_SCORE,
CONCAT_WS('', R_SCORE, F_SCORE, M_SCORE) AS RFM_COMBINATION
FROM RFM_SCORES RS
)




CREATE OR REPLACE VIEW RFM_VIEW AS
SELECT 
RC.*,
CASE
    WHEN RFM_COMBINATION IN (445,454,455,544,545,554,555) THEN 'CHAMPIONS'
    WHEN RFM_COMBINATION IN (335,343,344,345,354,355,443,444,543,553) THEN 'LOYAL'
    WHEN RFM_COMBINATION IN (323,341,342,351,352,431,441,442,451,452,531,541,542,551,552,
                             333,353,423,432,433,453,532,533) THEN 'POTENTIAL LOYALIST'
    WHEN RFM_COMBINATION IN (413,414,415,513,514,515,313,314,315,424,425,524,525,523) 
         THEN 'PROMISING'
    WHEN RFM_COMBINATION IN (324,325,434,435,534,535,334) THEN 'NEEDS ATTENTION'
    WHEN RFM_COMBINATION IN (135,145,214,144,154,155,245,254,255) THEN 'CANT LOSE'
    WHEN RFM_COMBINATION IN (411,412,421,422,511,512,521,522) THEN 'NEW CUSTOMER'
    WHEN RFM_COMBINATION IN (124,125,133,134,142,143,152,153,224,225,234,235,242,243,
                             244,252,253) THEN 'AT RISK'
    WHEN RFM_COMBINATION IN (122,123,132,211,212,213,221,222,223,231,232,241,251,311,312,
                             321,322,331,332,233) THEN 'ABOUT TO SLEEP'
    WHEN RFM_COMBINATION IN (111,112,113,114,115,121,131,141,151,215) THEN 'LOST CUSTOMER'
    ELSE 'OTHER'
END AS RFM_SEGMENTS
FROM RFM_COMBINATION RC;





SELECT 
RFM_SEGMENTS,
COUNT(RFM_SEGMENTS) AS NUMBER_OF_CUSTOMERS,
ROUND(AVG(RECENCY_VALUE),0) AS AVG_INACTIVITY,
ROUND(AVG(FREQUENCY_VALUE),1) AS AVG_FREQUENCY,
ROUND(AVG(MONETARY_VALUE),0) AS AVG_SPEND
FROM RFM_VIEW
GROUP BY RFM_SEGMENTS;

